image: node:8

cache:
  paths:
    - node_modules/
    - packages/ui-library/node_modules/
    - packages/end-user/node_modules/

stages:
  - build
  - test

build_packages:
  stage: build
  tags:
    - platform-publish-node-fragment
    - platform-build-node-ui-page
    - platform-build-node-fragment
  script:
  - npm i lerna
  - cd packages/ui-library
  - npm install
  - cd ../end-user
  - npm install
  - cd ../../


test_packages:
  stage: test
  tags:
    - platform-publish-node-fragment
    - platform-build-node-ui-page
    - platform-build-node-fragment
  script:
  - lerna run test
