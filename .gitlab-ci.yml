image: node:8

cache:
  untracked: true
  key: "$CI_BUILD_REF_NAME"
  paths:
  - node_modules/
  - packages/ui-library/node_modules/
  - packages/end-user/node_modules/

stages:
  - setup
  - test

setup:
  stage: setup
  tags:
    - platform-build-node-fragment
  script:
  - cd packages/ui-library
  - npm install
  - cd ../end-user
  - npm install
  - cd ../../


test:
  stage: test
  tags:
    - platform-build-node-fragment
  script:
  - npm i lerna -g
  - lerna run test
