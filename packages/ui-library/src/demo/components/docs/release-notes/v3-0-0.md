### New Environment Requirements

- **React**
    - UI Library V3 is designed for use with React 16, but also supports React 15.6.2.  Both are now available under with the new MIT license.

    - See **upgrading react** below for more information.

- **Babel**
    - Presets
        - The UI Library now supports transpiling of the latest ES versions supported by Babel.  The preset used is `“env”` with no specific configuration options set. This preset replaces the “latest” preset from Babel. You may specify your own environment options as needed. https://babeljs.io/docs/plugins/preset-env/

    - Plugins
        - The UI Library uses ES7+ Property Initializers to bind functions to class instances, removing the need for constructor binding. This requires the babel plugin `“transform class properties”`.
    https://babeljs.io/docs/plugins/transform-class-properties/

    - Below is the UI Library .babelrc with the minimum requirements to use the library
    ```
        {
        	"presets": [
                "env",
                "react"
            ],
            "plugins": [
                "transform-class-properties"
            ]
        }
    ```

### Breaking Changes
- **Removed Components**
    - UI Library V2 included deprecation warnings for specific components, mostly regarding components marked as V1. These have been removed.

    - Components with a removed V1:
        - FileUpload
            - src/components/forms/file-upload/v1.jsx
        - FormIntegerField
            - src/components/forms/form-integer-field/v1.jsx
        - FormTextArea
            - src/components/forms/form-text-area/v1.jsx
        - FormTextField
            - src/components/forms/form-text-field/v1.jsx
        - SelectionList
            - src/components/forms/selection-list/v1.jsx
        - Toggle
            - src/components/forms/form-toggle/v1.jsx
        - I18nPhoneInput
            - src/components/forms/i18n/phone-input/v1.jsx
        - ContextCloseButton
            - src/components/general/context-close-button/v1.jsx

    - Other components that have also been removed:
        - CollapsibleSection → use Section instead
            - src/components/general/CollapsibleSection.jsx
        - FormSelectField → use FormDropdownList instead
            - src/components/forms/form-select-field/*


- **Changed Components**
    - Drag and Drop Components
        - React DND has been upgraded to 2.5.4. This upgrade created conflicts with the way draggable components were wrapped in a DragDropContext. This has been removed from all draggable components and if your app uses draggable components, the top level of the app must be wrapped in the DragDropContext. An example from Demo.jsx in the Library:

            ```javascript
            import HTML5Backend from "react-dnd-html5-backend";
            import { DragDropContext } from "react-dnd";
            class DemoApp extends React.Component {};
            DemoApp = DragDropContext(HTML5Backend)(DemoApp);
            ```

        - The change affects codebases using the following components:
            - DragDragDrop
            - DragDropRow
            - DragDropColumn
            - MultiDrag
            - DragDropTable
    - ColorPicker
        - We have changed the core of our ColorPicker to use the npm react-color module, specifically the ChromePicker. Our ColorPicker api remains the same, however, if you have tests that target the DOM, they will need to be updated. [More info on react-color.](https://casesandberg.github.io/react-color/)


- **Removed Props**
    - UI Library V2 also included warnings for deprecated props. The following props are deprecated in V3 and will result in an error being thrown. In general the following has changed:
        - controlled → stateless
            - we've updated this because stateless is more descriptive than controlled. Your prop value will stay the same e.g. (`controlled={true}` simply becomes `stateless={true}`))
        - id → data-id
        - isRequired → required
        - onChange → onValueChange

<details>
    <summary><a>Click here to expand and see the specifics props removed in each component.</a></summary>
    ```
        - src/components/calendars/
            - Calendar.jsx
                - id → data-id
                - isRequired → required
                - onChange → onValueChange
        - src/components/forms/
            - file-upload/v2.jsx
                - controlled → stateless
                - title → labelText
            - form-integer-field/v2.jsx
                - controlled → stateless
            - form-text-area/v2.jsx
                - controlled → stateless
            - form-text-field/v2.jsx
                - controlled → stateless
            - form-toggle/v2.jsx
                - controlled → stateless
                - id → data-id
            - i18n/
                - I18nCountrySelector.jsx
                    - controlled → stateless
                    - onCountrySearch → onSearch
                - phone-input/v2.jsx
                    - controlled → stateless
                    - onCountrySearch → onSearch
            - selection-list/v2.jsx
                - controlled → stateless
            - DropDownButton.jsx
                - id → data-id
                - controlled → stateless
                - onSelect → onValueChange
            - FormCheckbox.jsx
                - id → data-id
            - FormCheckboxList.jsx
                - id → data-id
                - controlled → stateless
                - labelSelectAll → onGetSelectAllLabel
                - labelDeselectAll → onGetDeselectAllLabel
                - onSelectionChange → onValueChange
            - FormLabel.jsx
                - id → data-id
            - FormRadioGroup.jsx
                - id → data-id
                - onChange → onValueChange
            - FormTimeZone.jsx
                - controlled → stateless
            - Multivalues.jsx
                - id → data-id
                - isRequired → required
                - onChange → onValueChange
            - RockerButton.jsx
                - id → data-id
                - controlled → stateless
                - onChange → onValueChange
        - src/components/general/
            - ColorPicker.jsx
                - id → data-id
                - controlled → stateless
                - onChange → onValueChange
            - ColumnLayout.jsx
                - id → data-id
            - ConditionalFieldset.jsx
                - controlled → stateless
            - EllipsisLoader.jsx
                - id → data-id
            - EllipsisLoaderButton.jsx
                - id → data-id
                - onButtonClick → onClick
            - InlineMessage.jsx
                - callback → onClick
            - Messages.jsx
                - id → data-id
                - removeMessage → onRemoveMessage
                - i18n → onI18n
            - Modal.jsx
                - id → data-id
                - controlled → stateless
                - activatorContainerStyle → activatorContainerClassName
                - linkContent → activatorContent
                - linkStyle → activatorContentClassName
                - value → activatorButtonLabel
                - buttonStyle → activatorButtonClassName
                - containerStyle → className
            - Section.jsx
                - id → data-id
                - controlled → stateless
            - SelectText.jsx
                - dataId → data-id
            - Spinner.jsx
                - id → data-id
            - TabbedSections.jsx
                - id → data-id
                - onSectionChange → onValueChange
            - TimePicker.jsx
                - id → data-id
        - src/components/grid/
            - cells/
                - ButtonCell.jsx
                    - onCallBack → onGridCellAction
                - CheckboxCell.jsx
                    - onCallBack → onGridCellAction
                - TextFieldCell.jsx
                    - onCallBack → onGridCellAction
            - Grid.jsx
                - controlled → stateless
        - src/components/list/
            - InfiniteScroll.jsx
                - loadPrev → onLoadPrev
                - loadNext → onLoadNext
                - headingGenerator → onGenerateHeading
            - Pagination.jsx
                - id → data-id
                - controlled → stateless
                - onChange → onValueChange
        - src/components/panels/
            - header-bar/HeaderBar.jsx
                - label → siteTitle
            - left-nav/LeftNavBar.jsx
                - onSectionClick → onSectionValueChange
                - onItemClick → onItemValueChange
            - multi-drag/MultiDrag.jsx
                - controlled → stateless
        - src/components/rows/
            - expandable-row/ExpandableRow.jsx
                - controlled → stateless
                - defaultToExpanded → expanded
        - src/components/tooltips/
            - DetailsTooltip.jsx
                - id → data-id
                - controlled → stateless
                - contentClassNames → contentClassName
                - titleClassNames → titleClassName
                - labelStyle → labelClassName
                - positionStyle → positionClassName
            - HelpHint.jsx
                - id → data-id
        - src/components/wizard/
            - Choose.jsx
                - id → data-id
                - onChange → onValueChange
            - Progress.jsx
                - id → data-id
            - Step.jsx
                - id → data-id
                - nextButtonStyle → nextButtonClassName
                - doneButtonStyle → doneButtonClassName
            - Wizard.jsx
                - id → data-id
                - onChange → onValueChange
```
</details>

### Upgrading React
- **React 16**
    - `React.propTypes` has been moved to the prop-types package. React has provided a codemod script to make changing easier available [here](https://github.com/reactjs/react-codemod#react-proptypes-to-prop-types). We used this code to update the library with no issues
    - `React.createClass` has been moved to the create-react-class package. [This codemod](https://github.com/reactjs/react-codemod#explanation-of-the-new-es2015-class-transform-with-property-initializers) will convert your createClass to an ES6 component if it is able, or fall back to the create-react-class package if not. Non lifecycle methods become class property initializers (like `onClick = () => {};`). We used this successfully in the Library with a few caveats:
        - The codemod seems to choke on a large number of files (over 60 or 70). Using it on subfolders worked very well. *using the `-d` flag for a dry run first is recommended*
        - Files with non supported fields on the component cause issues. For example

        ```
        var RowIndexNavDemo = React.createClass({
                activeIndexes: "ABCEFGHIJLMNOPSTUVX".split(""),
                getInitialState: function () {
                    return {
                        selectedIndex: this.activeIndexes[0]
                    };
                },
        ```
        should be changed to
        ```
        const ACTIVE_INDEXES = "ABCEFGHIJLMNOPSTUVX".split("");
        var RowIndexNavDemo = React.createClass({
            getInitialState: function () {
                return {
                    selectedIndex: ACTIVE_INDEXES[0];
                };
            },
            componentWillMount: function () {
                this.activeIndexes = ACTIVE_INDEXES;
            }
        ```
        before running the codemod
    - Upgrading from a very old version of Jest (0.8.2 to 21.2.1) gave us the most problems when upgrading the library. Some issues we found:
        - react-addons-test-utils has been moved to react-dom/test-utils
        - Shallow renderer has been moved to "react-test-renderer" package
        - Setting properties directly on the document/window or DOM nodes may throw an error `Cannot set property stack of [object Object] which has only a getter`.

    - More React 16 info can be found here https://github.com/facebook/react/releases/tag/v16.0.0

- **React 15**
    - We highly recommend you upgrade to React 16, but if for some reason you are unable to migrate your code base. The UI Library v3 supports React 15.16.2.

    - data-reactid is no longer available. Some library Selenium tests previously used xpath to find the data-reactid  attributed that come from the key prop. These tests and components have been updated to use data-id instead.

    - Extra <span> markup has also been removed. If your tests targeting the DOM are failing, make sure the extra markup you expect is still there.

    - A full list of React 15 changes is available here
    https://reactjs.org/blog/2016/04/07/react-v15.html#changelog
